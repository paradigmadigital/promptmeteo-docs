<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="OpenAI - Test API Generation" href="06_test_openai_api-generation.html" /><link rel="prev" title="Flan-t5-Small - Test Classification Prompts" href="04_test_flant5_classification_prompts.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>OpenAI - Test Classification Prompts - üî•üßî</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">üî•üßî</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">üî•üßî</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../definition.html">ü§î What is this library for?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">‚öôÔ∏è Installation and configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">‚ö° Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">üëª Classes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example notebooks</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01_promptmeteo_usage.html">Promptmeteo Usage - Save and Load Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_sentiment_analysis.html">Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_test_flant5_classification_prompts.html">Flan-t5-Small - Test Classification Prompts</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">OpenAI - Test Classification Prompts</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_test_openai_api-generation.html">OpenAI - Test API Generation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="OpenAI---Test-Classification-Prompts">
<h1>OpenAI - Test Classification Prompts<a class="headerlink" href="#OpenAI---Test-Classification-Prompts" title="Permalink to this heading">#</a></h1>
<p>In this notebook we are going to use the <strong>Amazon Review Dataset</strong> to test Promptmeteo in the sentiment analysis task</p>
<section id="1.-Data-Preparation---EN---Build-sentiment-dataset.">
<h2>1. Data Preparation - EN - Build sentiment dataset.<a class="headerlink" href="#1.-Data-Preparation---EN---Build-sentiment-dataset." title="Permalink to this heading">#</a></h2>
<p>The dataset contains reviews from Amazon in English collected between November 1, 2015 and November 1, 2019. Each record in the dataset contains the review text, the review title, the star rating, an anonymized reviewer ID, an anonymized product ID and the coarse-grained product category (e.g. ‚Äòbooks‚Äô, ‚Äòappliances‚Äô, etc.). The corpus is balanced across stars, so each star rating constitutes 20% of the reviews in each language.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../data/amazon_reviews_en/amazon_reviews_multi-test.parquet&quot;</span><span class="p">)</span>
<span class="n">sql</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">SQLContext</span><span class="p">()</span>
<span class="n">sql</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="n">sentiment_data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">sql</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        review_body as REVIEW,</span>
<span class="s2">        CASE</span>
<span class="s2">            WHEN stars=1 THEN &#39;negative&#39;</span>
<span class="s2">            WHEN stars=3 THEN &#39;neutral&#39;</span>
<span class="s2">            WHEN stars=5 THEN &#39;positive&#39;</span>
<span class="s2">            ELSE null</span>
<span class="s2">        END AS TARGET,</span>
<span class="s2">    FROM data</span>
<span class="s2">    WHERE stars!=2 AND stars!=4;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">train_reviews</span> <span class="o">=</span> <span class="n">sentiment_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;REVIEW&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">train_targets</span> <span class="o">=</span> <span class="n">sentiment_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;TARGET&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">test_reviews</span> <span class="o">=</span> <span class="n">sentiment_data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;REVIEW&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">test_targets</span> <span class="o">=</span> <span class="n">sentiment_data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;TARGET&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">sentiment_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr > th,
.dataframe > tbody > tr > td {
  text-align: right;
}
</style>
<small>shape: (5, 2)</small><table border="1" class="dataframe"><thead><tr><th>REVIEW</th><th>TARGET</th></tr><tr><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;I reuse my Nes‚Ä¶</td><td>&quot;positive&quot;</td></tr><tr><td>&quot;Fits great kin‚Ä¶</td><td>&quot;positive&quot;</td></tr><tr><td>&quot;Movie freezes ‚Ä¶</td><td>&quot;negative&quot;</td></tr><tr><td>&quot;This is my thi‚Ä¶</td><td>&quot;positive&quot;</td></tr><tr><td>&quot;For the money,‚Ä¶</td><td>&quot;neutral&quot;</td></tr></tbody></table></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">token</span> <span class="o">=</span> <span class="s2">&quot;sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-EN---Sin-entrenamiento">
<h2>2. EN - Sin entrenamiento<a class="headerlink" href="#2.-EN---Sin-entrenamiento" title="Permalink to this heading">#</a></h2>
<section id="Prueba-1">
<h3>Prueba 1<a class="headerlink" href="#Prueba-1" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;I need you to help me with a text classification task.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;The texts you will be processing are from the </span><span class="si">{__DOMAIN__}</span><span class="s2"> domain.&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;I want you to classify the texts into one of the following categories:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;Please provide a step-by-step argument for your answer, explain why you</span>
<span class="s2">    believe your final choice is justified, and make sure to conclude your</span>
<span class="s2">    explanation with the name of the class you have selected as the correct</span>
<span class="s2">    one, in lowercase and without punctuation.&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;In your response, include only the name of the class as a single word, in</span>
<span class="s2">    lowercase, without punctuation, and without adding any other statements or</span>
<span class="s2">    words.&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;product reviews&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;neutral&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>
<span class="n">pred_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">pred_targets</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_12_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_12_1.png" />
</div>
</div>
</section>
<section id="Prueba-2">
<h3>Prueba 2<a class="headerlink" href="#Prueba-2" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;I need you to help me with a text classification task.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;The texts you will be processing are from the </span><span class="si">{__DOMAIN__}</span><span class="s2"> domain.&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;I want you to classify the texts into one of the following categories:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;Think step by step you answer.&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;In your response, include only the name of the class predicted.&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;product reviews&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;neutral&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_15_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_15_1.png" />
</div>
</div>
</section>
</section>
<section id="3.-EN---Con-entrenamiento">
<h2>3. EN - Con entrenamiento<a class="headerlink" href="#3.-EN---Con-entrenamiento" title="Permalink to this heading">#</a></h2>
<section id="id1">
<h3>Prueba 1<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;I need you to help me with a text classification task.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;The texts you will be processing are from the </span><span class="si">{__DOMAIN__}</span><span class="s2"> domain.&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;I want you to classify the texts into one of the following categories:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;Please provide a step-by-step argument for your answer, explain why you</span>
<span class="s2">    believe your final choice is justified, and make sure to conclude your</span>
<span class="s2">    explanation with the name of the class you have selected as the correct</span>
<span class="s2">    one, in lowercase and without punctuation.&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;In your response, include only the name of the class as a single word, in</span>
<span class="s2">    lowercase, without punctuation, and without adding any other statements or</span>
<span class="s2">    words.&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">examples</span><span class="o">=</span><span class="n">train_reviews</span><span class="p">,</span> <span class="n">annotations</span><span class="o">=</span><span class="n">train_targets</span><span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_19_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_19_1.png" />
</div>
</div>
</section>
<section id="id2">
<h3>Prueba 2<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;I need you to help me with a text classification task.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;The texts you will be processing are from the </span><span class="si">{__DOMAIN__}</span><span class="s2"> domain.&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;I want you to classify the texts into one of the following categories:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;Think step by step you answer.&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;In your response, include only the name of the class predicted.&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;product reviews&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;neutral&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">examples</span><span class="o">=</span><span class="n">train_reviews</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="n">train_targets</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_22_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_22_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
<section id="Prueba-3">
<h3>Prueba 3<a class="headerlink" href="#Prueba-3" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;I need you to help me with a text classification task.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>

<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;&quot;</span>

<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;&quot;</span>

<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>

<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;&quot;</span>

<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">examples</span><span class="o">=</span><span class="n">train_reviews</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="n">train_targets</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_27_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_27_1.png" />
</div>
</div>
</section>
</section>
<section id="4.-Data-Preparation---SP---Build-sentiment-dataset.">
<h2>4. Data Preparation - SP - Build sentiment dataset.<a class="headerlink" href="#4.-Data-Preparation---SP---Build-sentiment-dataset." title="Permalink to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../data/amazon_reviews_sp/amazon_reviews_multi-test.parquet&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">sql</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">SQLContext</span><span class="p">()</span>
<span class="n">sql</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="n">sentiment_data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">sql</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        review_body as REVIEW,</span>
<span class="s2">        CASE</span>
<span class="s2">            WHEN stars=1 THEN &#39;negative&#39;</span>
<span class="s2">            WHEN stars=3 THEN &#39;neutral&#39;</span>
<span class="s2">            WHEN stars=5 THEN &#39;positive&#39;</span>
<span class="s2">            ELSE null</span>
<span class="s2">        END AS TARGET,</span>
<span class="s2">    FROM data</span>
<span class="s2">    WHERE stars!=2 AND stars!=4;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
<span class="o">/</span>
<span class="n">train_reviews</span> <span class="o">=</span> <span class="n">sentiment_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;REVIEW&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">train_targets</span> <span class="o">=</span> <span class="n">sentiment_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;TARGET&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">test_reviews</span> <span class="o">=</span> <span class="n">sentiment_data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;REVIEW&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">test_targets</span> <span class="o">=</span> <span class="n">sentiment_data</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;TARGET&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">sentiment_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr > th,
.dataframe > tbody > tr > td {
  text-align: right;
}
</style>
<small>shape: (5, 2)</small><table border="1" class="dataframe"><thead><tr><th>REVIEW</th><th>TARGET</th></tr><tr><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;El filtro de d‚Ä¶</td><td>&quot;positive&quot;</td></tr><tr><td>&quot;Un poquito esc‚Ä¶</td><td>&quot;positive&quot;</td></tr><tr><td>&quot;Para qu√© decir‚Ä¶</td><td>&quot;negative&quot;</td></tr><tr><td>&quot;Mi hija esta e‚Ä¶</td><td>&quot;positive&quot;</td></tr><tr><td>&quot;Se podr√≠a mejo‚Ä¶</td><td>&quot;neutral&quot;</td></tr></tbody></table></div></div>
</div>
</section>
<section id="5-SP---Sin-Entrenamiento">
<h2>5 SP - Sin Entrenamiento<a class="headerlink" href="#5-SP---Sin-Entrenamiento" title="Permalink to this heading">#</a></h2>
<section id="id3">
<h3>Prueba 1<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;Necesito que me ayudes en una tarea de clasificaci√≥n de texto.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;Los textos que vas procesar del ambito de </span><span class="si">{__DOMAIN__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;Quiero que me clasifiques los textos una de las siguientes categor√≠as:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;Por favor argumenta tu respuesta paso a paso, explica por qu√© crees que</span>
<span class="s2">    est√° justificada tu elecci√≥n final, y aseg√∫rate de que acabas tu</span>
<span class="s2">    explicaci√≥n con el nombre de la clase que has escogido como la</span>
<span class="s2">    correcta, en min√∫scula y sin puntuaci√≥n.&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;En tu respuesta incluye s√≥lo el nombre de la clase, como una √∫nica</span>
<span class="s2">    palabra, en min√∫scula, sin puntuaci√≥n, y sin a√±adir ninguna otra</span>
<span class="s2">    afirmaci√≥n o palabra.&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;es&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;opiniones de productos&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positiva&quot;</span><span class="p">,</span> <span class="s2">&quot;negativa&quot;</span><span class="p">,</span> <span class="s2">&quot;neutral&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>
<span class="n">pred_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">pred_targets</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_38_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_38_1.png" />
</div>
</div>
</section>
<section id="id4">
<h3>Prueba 2<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;Necesito que me ayudes en una tarea de clasificaci√≥n de texto.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;Los textos que vas procesar del ambito de </span><span class="si">{__DOMAIN__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;Quiero que me clasifiques los textos una de las siguientes categor√≠as:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;Argumenta tu respuesta paso a paso.&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;En tu respuesta incluye s√≥lo el nombre de la clase, como una √∫nica</span>
<span class="s2">    respuesta&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;es&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;opiniones de productos&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positiva&quot;</span><span class="p">,</span> <span class="s2">&quot;negativa&quot;</span><span class="p">,</span> <span class="s2">&quot;neutra&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_41_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_41_1.png" />
</div>
</div>
</section>
<section id="id5">
<h3>Prueba 3<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;Necesito que me ayudes en una tarea de clasificaci√≥n de texto.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;Quiero que me clasifiques los textos una de las siguientes categor√≠as:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;es&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;opiniones de productos&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positiva&quot;</span><span class="p">,</span> <span class="s2">&quot;negativa&quot;</span><span class="p">,</span> <span class="s2">&quot;neutra&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>
<span class="n">pred_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">pred_targets</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_44_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_44_1.png" />
</div>
</div>
</section>
</section>
<section id="ES---Con-entrenamiento">
<h2>ES - Con entrenamiento<a class="headerlink" href="#ES---Con-entrenamiento" title="Permalink to this heading">#</a></h2>
<section id="id6">
<h3>Prueba 1<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;Necesito que me ayudes en una tarea de clasificaci√≥n de texto.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;Los textos que vas procesar del ambito de </span><span class="si">{__DOMAIN__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;Quiero que me clasifiques los textos una de las siguientes categor√≠as:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;Por favor argumenta tu respuesta paso a paso, explica por qu√© crees que</span>
<span class="s2">    est√° justificada tu elecci√≥n final, y aseg√∫rate de que acabas tu</span>
<span class="s2">    explicaci√≥n con el nombre de la clase que has escogido como la</span>
<span class="s2">    correcta, en min√∫scula y sin puntuaci√≥n.&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;En tu respuesta incluye s√≥lo el nombre de la clase, como una √∫nica</span>
<span class="s2">    palabra, en min√∫scula, sin puntuaci√≥n, y sin a√±adir ninguna otra</span>
<span class="s2">    afirmaci√≥n o palabra.&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;es&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;opiniones de productos&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positiva&quot;</span><span class="p">,</span> <span class="s2">&quot;negativa&quot;</span><span class="p">,</span> <span class="s2">&quot;neutra&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">examples</span><span class="o">=</span><span class="n">train_reviews</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="n">train_targets</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>
<span class="n">pred_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">pred_targets</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_48_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_48_1.png" />
</div>
</div>
</section>
<section id="id7">
<h3>Prueba 2<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;Necesito que me ayudes en una tarea de clasificaci√≥n de texto.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;Los textos que vas procesar del ambito de </span><span class="si">{__DOMAIN__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;Quiero que me clasifiques los textos una de las siguientes categor√≠as:</span>
<span class="s2">    </span><span class="si">{__LABELS__}</span><span class="s2">.&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;Argumenta tu respuesta paso a paso.&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;En tu respuesta incluye s√≥lo el nombre de la clase, como una √∫nica</span>
<span class="s2">    respuesta&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;es&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;opiniones de productos&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positiva&quot;</span><span class="p">,</span> <span class="s2">&quot;negativa&quot;</span><span class="p">,</span> <span class="s2">&quot;neutra&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">examples</span><span class="o">=</span><span class="n">train_reviews</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="n">train_targets</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>
<span class="n">pred_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">pred_targets</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_51_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_51_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_targets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;positiva&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;]]
</pre></div></div>
</div>
</section>
<section id="id8">
<h3>Prueba 3<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">TEMPLATE:</span>
<span class="s2">    &quot;Necesito que me ayudes en una tarea de clasificaci√≥n de texto.</span>
<span class="s2">    </span><span class="si">{__PROMPT_DOMAIN__}</span>
<span class="s2">    </span><span class="si">{__PROMPT_LABELS__}</span>

<span class="s2">    </span><span class="si">{__CHAIN_THOUGHT__}</span>
<span class="s2">    </span><span class="si">{__ANSWER_FORMAT__}</span><span class="s2">&quot;</span>


<span class="s2">PROMPT_DOMAIN:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">PROMPT_LABELS:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">PROMPT_DETAIL:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">CHAIN_THOUGHT:</span>
<span class="s2">    &quot;&quot;</span>


<span class="s2">ANSWER_FORMAT:</span>
<span class="s2">    &quot;&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
    <span class="n">language</span><span class="o">=</span><span class="s2">&quot;es&quot;</span><span class="p">,</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span>
    <span class="n">model_provider_name</span><span class="o">=</span><span class="s2">&quot;openai&quot;</span><span class="p">,</span>
    <span class="n">model_provider_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>
    <span class="n">prompt_domain</span><span class="o">=</span><span class="s2">&quot;opiniones de productos&quot;</span><span class="p">,</span>
    <span class="n">prompt_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;positiva&quot;</span><span class="p">,</span> <span class="s2">&quot;negativa&quot;</span><span class="p">,</span> <span class="s2">&quot;neutra&quot;</span><span class="p">],</span>
    <span class="n">selector_k</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">read_prompt</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">examples</span><span class="o">=</span><span class="n">train_reviews</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="n">train_targets</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pred_targets</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_reviews</span><span class="p">)</span>
<span class="n">pred_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">pred</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">pred_targets</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_targets</span><span class="p">,</span> <span class="n">pred_targets</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_05_test_openai_classification_prompts_55_1.png" src="../_images/notebooks_05_test_openai_classification_prompts_55_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_targets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;],
 [&#39;&#39;],
 [&#39;neutra&#39;]]
</pre></div></div>
</div>
</section>
</section>
<section id="Conclusiones">
<h2>Conclusiones<a class="headerlink" href="#Conclusiones" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Parece que con el modelo Flan-t5-small, el mejor resultado se obtiene a√±adiendo m√°s ejemplot y quitando la instrucci√≥n del prompt</p></li>
<li><p>Parece que hay mucho errores asociados con que la respuesta tenga un espacio antes de laa respuesta</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="06_test_openai_api-generation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">OpenAI - Test API Generation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="04_test_flant5_classification_prompts.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Flan-t5-Small - Test Classification Prompts</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023 - 2024, Paradigma Digital
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">OpenAI - Test Classification Prompts</a><ul>
<li><a class="reference internal" href="#1.-Data-Preparation---EN---Build-sentiment-dataset.">1. Data Preparation - EN - Build sentiment dataset.</a></li>
<li><a class="reference internal" href="#2.-EN---Sin-entrenamiento">2. EN - Sin entrenamiento</a><ul>
<li><a class="reference internal" href="#Prueba-1">Prueba 1</a></li>
<li><a class="reference internal" href="#Prueba-2">Prueba 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-EN---Con-entrenamiento">3. EN - Con entrenamiento</a><ul>
<li><a class="reference internal" href="#id1">Prueba 1</a></li>
<li><a class="reference internal" href="#id2">Prueba 2</a></li>
<li><a class="reference internal" href="#Prueba-3">Prueba 3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.-Data-Preparation---SP---Build-sentiment-dataset.">4. Data Preparation - SP - Build sentiment dataset.</a></li>
<li><a class="reference internal" href="#5-SP---Sin-Entrenamiento">5 SP - Sin Entrenamiento</a><ul>
<li><a class="reference internal" href="#id3">Prueba 1</a></li>
<li><a class="reference internal" href="#id4">Prueba 2</a></li>
<li><a class="reference internal" href="#id5">Prueba 3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ES---Con-entrenamiento">ES - Con entrenamiento</a><ul>
<li><a class="reference internal" href="#id6">Prueba 1</a></li>
<li><a class="reference internal" href="#id7">Prueba 2</a></li>
<li><a class="reference internal" href="#id8">Prueba 3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Conclusiones">Conclusiones</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e936e8a8"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>