<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Sentiment Analysis" href="03_sentiment_analysis.html" /><link rel="prev" title="üëª Classes" href="../classes.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Promptmeteo Usage - Save and Load Model - üî•üßî</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">üî•üßî</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">üî•üßî</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../definition.html">ü§î What is this library for?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">‚öôÔ∏è Installation and configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">‚ö° Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">üëª Classes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example notebooks</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Promptmeteo Usage - Save and Load Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_sentiment_analysis.html">Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_test_flant5_classification_prompts.html">Flan-t5-Small - Test Classification Prompts</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_test_openai_classification_prompts.html">OpenAI - Test Classification Prompts</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_test_openai_api-generation.html">OpenAI - Test API Generation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="Promptmeteo-Usage---Save-and-Load-Model">
<h1>Promptmeteo Usage - Save and Load Model<a class="headerlink" href="#Promptmeteo-Usage---Save-and-Load-Model" title="Permalink to this heading">#</a></h1>
<section id="1.-Create-a-model">
<h2>1. Create a model<a class="headerlink" href="#1.-Create-a-model" title="Permalink to this heading">#</a></h2>
<section id="1.1-Instance-a-DocumentClassifier">
<h3>1.1 Instance a DocumentClassifier<a class="headerlink" href="#1.1-Instance-a-DocumentClassifier" title="Permalink to this heading">#</a></h3>
<p>In this example, we are going to create a model that performs a classic NLP task: document classification. It‚Äôs one of the tasks inPromptmeteo has a specific task to do that</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
        <span class="n">language</span>            <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
        <span class="n">model_provider_name</span> <span class="o">=</span> <span class="s1">&#39;hf_pipeline&#39;</span><span class="p">,</span>
        <span class="n">model_name</span>          <span class="o">=</span> <span class="s1">&#39;google/flan-t5-small&#39;</span><span class="p">,</span>
        <span class="n">prompt_labels</span>       <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="1.2-Prompt-Templates">
<h3>1.2 Prompt Templates<a class="headerlink" href="#1.2-Prompt-Templates" title="Permalink to this heading">#</a></h3>
<p>First, we need to write a helper function to print YAML files in a proper way.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaml</span>

<span class="k">def</span> <span class="nf">prompt_print</span><span class="p">(</span><span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints YAML prompts in a nice way.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">yaml_prompt</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">yaml_prompt</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="1.2.1-Predefined-prompt-templates">
<h4>1.2.1 Predefined prompt templates<a class="headerlink" href="#1.2.1-Predefined-prompt-templates" title="Permalink to this heading">#</a></h4>
<p>Promptmeteo has predefined prompt templates for each of the availables languages, models and tasks. This allows the user not to wonder about defining the prefect prompt but rather, to parametrize the prompt with the parameters of the use case. For the document classification task in english with OpenAI, the prompt template is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt_print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">PROMPT_EXAMPLE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TEMPLATE
 I need you to help me with a text classification task. {__PROMPT_DOMAIN__} {__PROMPT_LABELS__}
{__CHAIN_THOUGHT__} {__ANSWER_FORMAT__}
PROMPT_DOMAIN
 The texts you will be processing are from the {__DOMAIN__} domain.
PROMPT_LABELS
 I want you to classify the texts into one of the following categories: {__LABELS__}.
PROMPT_DETAIL

CHAIN_THOUGHT

ANSWER_FORMAT
 In your response, include only the name of the class predicted.
</pre></div></div>
</div>
</section>
<section id="1.2.2-Prompt-text---Prompt-injection">
<h4>1.2.2 Prompt text - Prompt injection<a class="headerlink" href="#1.2.2-Prompt-text---Prompt-injection" title="Permalink to this heading">#</a></h4>
<p>This template is used to build a prompt text by adding the stament bellow into the template. This technique is called <strong>prompt injection</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt_print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
I need you to help me with a text classification task.  I want you to classify the texts into one of the following categories
 positive, negative. In your response, include only the name of the class predicted.
</pre></div></div>
</div>
</section>
<section id="1.2.3-Injecting-labels---Zero-shot-Prompting">
<h4>1.2.3 Injecting labels - Zero-shot Prompting<a class="headerlink" href="#1.2.3-Injecting-labels---Zero-shot-Prompting" title="Permalink to this heading">#</a></h4>
<p>We can see tha not only the prompt has beenn build correctly, but also the labels <code class="docutils literal notranslate"><span class="pre">['positive',</span> <span class="pre">'negative']</span></code> from the class inicialitations has been injected. Given the labels without more examples is called <strong>Zero-shot prompting</strong></p>
<p>I need you to help me with a text classification task. I want you to classify the texts into one of the following categories: <strong>positive, negative.</strong> Please provide a step-by-step argument for your answer, explain why you believe your final choice is justified, and make sure to conclude your explanation with the name of the class you have selected as the correct one, in lowercase and without punctuation. In your response, include only the name of the class as a single word, in lowercase, without
punctuation, and without adding any other statements or words.</p>
<hr class="docutils" />
</section>
</section>
</section>
<section id="2.-Train-a-model">
<h2>2. Train a model<a class="headerlink" href="#2.-Train-a-model" title="Permalink to this heading">#</a></h2>
<section id="2.1-Train-function">
<h3>2.1 Train function<a class="headerlink" href="#2.1-Train-function" title="Permalink to this heading">#</a></h3>
<p>The model can be trained by giving examples to the function <code class="docutils literal notranslate"><span class="pre">train()</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">examples</span>    <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i am happy&#39;</span><span class="p">,</span> <span class="s1">&#39;I like it&#39;</span><span class="p">,</span> <span class="s1">&#39;I hate it&#39;</span><span class="p">],</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="2.2-Examples-Injection---Few-shot-prompting">
<h3>2.2 Examples Injection - Few-shot prompting<a class="headerlink" href="#2.2-Examples-Injection---Few-shot-prompting" title="Permalink to this heading">#</a></h3>
<p>When a new sample cames, the examples are added to the prompt to help the model to improve the answers. This technique is called <strong>Few-show prompting</strong>. This examples are choosed rom those that are more related to the new sample passes for makein inference. We can see that now, the prompt with the examples has the following aspect</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">_get_prompt</span><span class="p">(</span><span class="s1">&#39;NEW EXAMPLE&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 I need you to help me with a text classification task.  I want you to classify the texts into one of the following categories: positive, negative.
 In your response, include only the name of the class predicted.

INPUT: I like it
OUTPUT: positive

INPUT: I hate it
OUTPUT: negative

INPUT: i am happy
OUTPUT: positive

INPUT: NEW EXAMPLE
OUTPUT:
</pre></div></div>
</div>
</section>
<section id="2.3-Save-Model---FAISS">
<h3>2.3 Save Model - FAISS<a class="headerlink" href="#2.3-Save-Model---FAISS" title="Permalink to this heading">#</a></h3>
<p>The examples given to the function train are saved in a vectorstore in local (with FAISS) and this vectorstore can be serialized to disk. Saving this examples in disk allow us to easily reuse it from new use cases without having to recover the original data again</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;my_classifier.meteo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;promptmeteo.document_classifier.DocumentClassifier at 0x7f32142f4d50&gt;
</pre></div></div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="3.-Load-a-model">
<h2>3. Load a model<a class="headerlink" href="#3.-Load-a-model" title="Permalink to this heading">#</a></h2>
<section id="3.1-Model-creation">
<h3>3.1 Model creation<a class="headerlink" href="#3.1-Model-creation" title="Permalink to this heading">#</a></h3>
<p>For reloading a model we have to intanciate a <code class="docutils literal notranslate"><span class="pre">DocumentClassifier</span></code> and use the function <code class="docutils literal notranslate"><span class="pre">load_model()</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">new_clf</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
        <span class="n">language</span>            <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
        <span class="n">model_provider_name</span> <span class="o">=</span> <span class="s1">&#39;hf_pipeline&#39;</span><span class="p">,</span>
        <span class="n">model_name</span>          <span class="o">=</span> <span class="s1">&#39;google/flan-t5-small&#39;</span><span class="p">,</span>
        <span class="n">prompt_labels</span>       <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;my_classifier.meteo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="3.2-Predict-new-data">
<h3>3.2 Predict new data<a class="headerlink" href="#3.2-Predict-new-data" title="Permalink to this heading">#</a></h3>
<p>By calling the function <code class="docutils literal notranslate"><span class="pre">predict()</span></code> we can use the prompt created with the examples loaded again to predict the classification over new data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="s1">&#39;so cool!!&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&#39;positive&#39;]]
</pre></div></div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="4-Conclusions">
<h2>4 Conclusions<a class="headerlink" href="#4-Conclusions" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>In this example we have shown how Promptmeteo can be used as a machine learning frameworks such as Scikit-Learn o Pytorch. It has a similar interface with allows to save the results from the training in a binary file and reuse it. This eases the integration of LLM solution in ML pipeline tools such as Sagemaker or Vertex.</p></li>
<li><p>Promptmeteo does not only include code data to simplify the integration to LLM model and services. It also include predefined Prompt Engineer logic for different models and tasks. It allows to focus on developing a solution rather than writting prompts, and ensures that the prompt has been tested correctly by Promptmeteo, which make this kind os solution less error-prone.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="03_sentiment_analysis.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Sentiment Analysis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../classes.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">üëª Classes</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023 - 2024, Paradigma Digital
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Promptmeteo Usage - Save and Load Model</a><ul>
<li><a class="reference internal" href="#1.-Create-a-model">1. Create a model</a><ul>
<li><a class="reference internal" href="#1.1-Instance-a-DocumentClassifier">1.1 Instance a DocumentClassifier</a></li>
<li><a class="reference internal" href="#1.2-Prompt-Templates">1.2 Prompt Templates</a><ul>
<li><a class="reference internal" href="#1.2.1-Predefined-prompt-templates">1.2.1 Predefined prompt templates</a></li>
<li><a class="reference internal" href="#1.2.2-Prompt-text---Prompt-injection">1.2.2 Prompt text - Prompt injection</a></li>
<li><a class="reference internal" href="#1.2.3-Injecting-labels---Zero-shot-Prompting">1.2.3 Injecting labels - Zero-shot Prompting</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#2.-Train-a-model">2. Train a model</a><ul>
<li><a class="reference internal" href="#2.1-Train-function">2.1 Train function</a></li>
<li><a class="reference internal" href="#2.2-Examples-Injection---Few-shot-prompting">2.2 Examples Injection - Few-shot prompting</a></li>
<li><a class="reference internal" href="#2.3-Save-Model---FAISS">2.3 Save Model - FAISS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-Load-a-model">3. Load a model</a><ul>
<li><a class="reference internal" href="#3.1-Model-creation">3.1 Model creation</a></li>
<li><a class="reference internal" href="#3.2-Predict-new-data">3.2 Predict new data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4-Conclusions">4 Conclusions</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e936e8a8"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>