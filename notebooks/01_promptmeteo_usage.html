<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Sentiment Analysis" href="03_sentiment_analysis.html" /><link rel="prev" title="üëª Classes" href="../classes.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Promptmeteo Usage - Save and Load Model - üî•üßî</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">üî•üßî</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">üî•üßî</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../definition.html">ü§î What is this library for?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">‚öôÔ∏è Installation and configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">‚ö° Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../classes.html">üëª Classes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example notebooks</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Promptmeteo Usage - Save and Load Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_sentiment_analysis.html">Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_test_flant5_classification_prompts.html">Flan-t5-Small - Test Classification Prompts</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_test_openai_classification_prompts.html">OpenAI - Test Classification Prompts</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_test_openai_api-generation.html">OpenAI - Test API Generation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="Promptmeteo-Usage---Save-and-Load-Model">
<h1>Promptmeteo Usage - Save and Load Model<a class="headerlink" href="#Promptmeteo-Usage---Save-and-Load-Model" title="Permalink to this heading">#</a></h1>
<p>LLMs are truly revolutionizing the world, enabling humans to do things we couldn‚Äôt do before, or making them so much easier and faster to do.</p>
<p>Promptmeteo leverages the power of LLMs to democratize the data science process. This means you can easily train a model and make predictions with it in a few, comfortable steps.</p>
<p>In this tutorial, you are going to create a model to perform document classification (a classic NLP task), train it with a manageable amount of data, save it, load it and use it to classify new documents.</p>
<section id="1.-Create-a-model">
<h2>1. Create a model<a class="headerlink" href="#1.-Create-a-model" title="Permalink to this heading">#</a></h2>
<section id="1.1-Instance-a-DocumentClassifier">
<h3>1.1 Instance a DocumentClassifier<a class="headerlink" href="#1.1-Instance-a-DocumentClassifier" title="Permalink to this heading">#</a></h3>
<p>Luckily, Promptmeteo has a specific task to do document classification. You only have to instance the class DocumentClassifier, and it‚Äôs very easy to do so. You have to set: - <code class="docutils literal notranslate"><span class="pre">language</span></code>: the language in which the task is going to be performed (currently, only English or Spanish are supported) - <code class="docutils literal notranslate"><span class="pre">model_name</span></code> and <code class="docutils literal notranslate"><span class="pre">model_provider_name</span></code>: the model and provider you want to use (currently, <a class="reference external" href="https://paradigmadigital.github.io/promptmeteo-docs/definition.html#available-models">these</a> are
supported) - <code class="docutils literal notranslate"><span class="pre">prompt_labels</span></code>: the categories in which you need to classify the documents (free choice)</p>
<p>Let‚Äôs use <code class="docutils literal notranslate"><span class="pre">google/flan-t5-small</span></code>, which is free, in English, and go for the classic sentiment classification, that is, using the <code class="docutils literal notranslate"><span class="pre">positive</span></code> and <code class="docutils literal notranslate"><span class="pre">negative</span></code> labels to classify opinions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
        <span class="n">language</span>            <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
        <span class="n">model_provider_name</span> <span class="o">=</span> <span class="s1">&#39;hf_pipeline&#39;</span><span class="p">,</span>
        <span class="n">model_name</span>          <span class="o">=</span> <span class="s1">&#39;google/flan-t5-small&#39;</span><span class="p">,</span>
        <span class="n">prompt_labels</span>       <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="1.2-Prompts">
<h3>1.2 Prompts<a class="headerlink" href="#1.2-Prompts" title="Permalink to this heading">#</a></h3>
<p>The first thing you need to know about Promptmeteo is that we think <strong>prompts should be treated with the same respect as code</strong>. Therefore, they shouldn‚Äôt be hard-coded or taken lightly; instead, they should be carefully designed and properly versioned. In the end, they are the way we communicate with the LLMs. That means a mistake in a prompt can result in major unwanted outputs, while a really good prompt can unleash all the power from the LLM.</p>
<p>That said, prompt templates in Promptmeteo are written in YAML and saved in files. So first, we need to write a helper function to print YAML files in a proper way.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaml</span>

<span class="k">def</span> <span class="nf">prompt_print</span><span class="p">(</span><span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints YAML prompts in a nice way.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">yaml_prompt</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">yaml_prompt</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="1.2.1-Prompt-templates">
<h4>1.2.1 Prompt templates<a class="headerlink" href="#1.2.1-Prompt-templates" title="Permalink to this heading">#</a></h4>
<p>Promptmeteo has predefined <strong>prompt templates</strong> for each of the available languages, models and tasks. This allows the user not to wonder about defining the perfect prompt, but rather to parametrize the prompt template with the parameters of the use case, without neglecting the prompts.</p>
<p>Let‚Äôs have a look into the prompt template for the document classification task in English with FlanTL:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt_print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">PROMPT_EXAMPLE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TEMPLATE
 I need you to help me with a text classification task. {__PROMPT_DOMAIN__} {__PROMPT_LABELS__}
{__CHAIN_THOUGHT__} {__ANSWER_FORMAT__} {__SHOT_EXAMPLES__} {__PROMPT_SAMPLE__}
PROMPT_DOMAIN
 The texts you will be processing are from the {__DOMAIN__} domain.
PROMPT_LABELS
 I want you to classify the texts into one of the following categories: {__LABELS__}.
PROMPT_DETAIL

SHOT_EXAMPLES
 Examples:

{__EXAMPLES__}
PROMPT_SAMPLE


{__SAMPLE__}

CHAIN_THOUGHT

ANSWER_FORMAT
 In your response, include only the name of the class predicted.
</pre></div></div>
</div>
</section>
<section id="1.2.2-Prompt-texts">
<h4>1.2.2 Prompt texts<a class="headerlink" href="#1.2.2-Prompt-texts" title="Permalink to this heading">#</a></h4>
<p>The prompt template is used to build a <strong>prompt text</strong>, which is the final text to pass to the LLM. We haven‚Äôt provided any example yet, only the labels, so it looks like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
I need you to help me with a text classification task. The texts you will be processing are from the  domain. I want you to classify the texts into one of the following categories: positive, negative.
 In your response, include only the name of the class predicted. Examples:

{__EXAMPLES__}

{__SAMPLE__}

</pre></div></div>
</div>
<p>We could use the above text as the prompt as is, it‚Äôs a valid approach called <strong>zero-shot prompting</strong>. But usually we will need to show the LLM some examples of what we want it to do; and that means we need to train it.</p>
<hr class="docutils" />
</section>
</section>
</section>
<section id="2.-Train-a-model">
<h2>2. Train a model<a class="headerlink" href="#2.-Train-a-model" title="Permalink to this heading">#</a></h2>
<section id="2.1-train()-function">
<h3>2.1 <code class="docutils literal notranslate"><span class="pre">train()</span></code> function<a class="headerlink" href="#2.1-train()-function" title="Permalink to this heading">#</a></h3>
<p>As in any data science pipeline, you can train models in Promptmeteo. You simply have to give examples to it using the <code class="docutils literal notranslate"><span class="pre">train()</span></code> function, providing the texts (<code class="docutils literal notranslate"><span class="pre">examples</span></code>) and their expected classification (<code class="docutils literal notranslate"><span class="pre">annotations</span></code>):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">examples</span>    <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i am happy&#39;</span><span class="p">,</span> <span class="s1">&#39;I like it&#39;</span><span class="p">,</span> <span class="s1">&#39;I hate it&#39;</span><span class="p">],</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="2.2-Examples-injection">
<h3>2.2 Examples injection<a class="headerlink" href="#2.2-Examples-injection" title="Permalink to this heading">#</a></h3>
<p>Each example is added to the prompt to help the model improve the answers. When the number of examples is low, this technique is called <strong>few-shot prompting</strong>.</p>
<p>These examples should be chosen from those that are more related to the new sample passed for making inference. We can see that now the prompt with the examples has the following aspect:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_for_inference</span> <span class="o">=</span> <span class="s1">&#39;I love it&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">_get_prompt</span><span class="p">(</span><span class="n">example_for_inference</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
I need you to help me with a text classification task. The texts you will be processing are from the  domain. I want you to classify the texts into one of the following categories: positive, negative.
 In your response, include only the name of the class predicted. Examples:

I like it
positive

I hate it
negative

i am happy
positive

I love it

</pre></div></div>
</div>
</section>
<section id="2.3-Save-model">
<h3>2.3 Save model<a class="headerlink" href="#2.3-Save-model" title="Permalink to this heading">#</a></h3>
<p>The examples passed to the <code class="docutils literal notranslate"><span class="pre">train()</span></code> function are saved in a vectorstore in local (with FAISS) and this vectorstore can be serialized to disk. Saving these examples in disk allows us to easily reuse them for new use cases, without having to retrieve the original data again.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;my_classifier.meteo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;promptmeteo.document_classifier.DocumentClassifier at 0x7ff4221a8ee0&gt;
</pre></div></div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="3.-Load-a-model">
<h2>3. Load a model<a class="headerlink" href="#3.-Load-a-model" title="Permalink to this heading">#</a></h2>
<section id="3.1-Model-creation">
<h3>3.1 Model creation<a class="headerlink" href="#3.1-Model-creation" title="Permalink to this heading">#</a></h3>
<p>Now that we have saved a model, we can load it. To load a model we have to intantiate a <code class="docutils literal notranslate"><span class="pre">DocumentClassifier</span></code> as we did before and use the function <code class="docutils literal notranslate"><span class="pre">load_model()</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">promptmeteo</span> <span class="kn">import</span> <span class="n">DocumentClassifier</span>

<span class="n">new_clf</span> <span class="o">=</span> <span class="n">DocumentClassifier</span><span class="p">(</span>
        <span class="n">language</span>            <span class="o">=</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span>
        <span class="n">model_provider_name</span> <span class="o">=</span> <span class="s1">&#39;hf_pipeline&#39;</span><span class="p">,</span>
        <span class="n">model_name</span>          <span class="o">=</span> <span class="s1">&#39;google/flan-t5-small&#39;</span><span class="p">,</span>
        <span class="n">prompt_labels</span>       <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;my_classifier.meteo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="3.2-Predict-new-data">
<h3>3.2 Predict new data<a class="headerlink" href="#3.2-Predict-new-data" title="Permalink to this heading">#</a></h3>
<p>And now we are ready to predict labels for new data! By calling the function <code class="docutils literal notranslate"><span class="pre">predict()</span></code> we can use the prompt created with the examples to predict the classification over new data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="s1">&#39;so cool!!&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&#39;positive&#39;]]
</pre></div></div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="4-Conclusions">
<h2>4 Conclusions<a class="headerlink" href="#4-Conclusions" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>In this example we have shown how Promptmeteo can be used as a machine learning framework such as Scikit-Learn or Pytorch. It has a similar interface which allows to save the results from the training in a binary file and reuse it. This eases the integration of the LLM solution in ML pipeline tools such as Sagemaker or Vertex.</p></li>
<li><p>Promptmeteo does not only include code data to simplify the integration of LLM model and services. It also includes predefined prompt engineering logic for different models and tasks. It allows to focus on developing a solution rather than writting prompts, and ensures that the prompt has been tested correctly by Promptmeteo, which makes this kind of solution less error-prone.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="03_sentiment_analysis.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Sentiment Analysis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../classes.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">üëª Classes</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023 - 2024, Paradigma Digital
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Promptmeteo Usage - Save and Load Model</a><ul>
<li><a class="reference internal" href="#1.-Create-a-model">1. Create a model</a><ul>
<li><a class="reference internal" href="#1.1-Instance-a-DocumentClassifier">1.1 Instance a DocumentClassifier</a></li>
<li><a class="reference internal" href="#1.2-Prompts">1.2 Prompts</a><ul>
<li><a class="reference internal" href="#1.2.1-Prompt-templates">1.2.1 Prompt templates</a></li>
<li><a class="reference internal" href="#1.2.2-Prompt-texts">1.2.2 Prompt texts</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#2.-Train-a-model">2. Train a model</a><ul>
<li><a class="reference internal" href="#2.1-train()-function">2.1 <code class="docutils literal notranslate"><span class="pre">train()</span></code> function</a></li>
<li><a class="reference internal" href="#2.2-Examples-injection">2.2 Examples injection</a></li>
<li><a class="reference internal" href="#2.3-Save-model">2.3 Save model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-Load-a-model">3. Load a model</a><ul>
<li><a class="reference internal" href="#3.1-Model-creation">3.1 Model creation</a></li>
<li><a class="reference internal" href="#3.2-Predict-new-data">3.2 Predict new data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4-Conclusions">4 Conclusions</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e936e8a8"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>